(this["webpackJsonpnussinov-rna-visualizer"]=this["webpackJsonpnussinov-rna-visualizer"]||[]).push([[0],{102:function(t,e,n){"use strict";n.r(e);var r=n(1),a=n.n(r),i=n(22),c=n.n(i),s=n(2),o=n(0);function u(t){var e=2*Math.PI*270/360;return t>1&&(e+=2*Math.PI/t/2),e%(2*Math.PI)}function l(t,e){return[Math.cos(e+2*t*Math.PI),Math.sin(e+2*t*Math.PI)]}var h=function(t){var e=Object(r.useRef)(null),n=t.bases,a=t.pairs;return Object(r.useEffect)((function(){e.current&&function(t,e,n,r){var a=t.getContext("2d");if(null!==a){var i=r,c=Math.floor(r/2.4),o=r/2,h=i/2,d=u(e.length);e.length<2?(a.lineWidth=2,a.beginPath(),a.arc(o,h,c,d+0,d+2*Math.PI),a.stroke()):(a.lineWidth=.3,a.beginPath(),a.arc(o,h,c,d+2*Math.PI*(e.length-1)/e.length,d+2*Math.PI),a.stroke(),a.lineWidth=2,a.beginPath(),a.arc(o,h,c,d+0,d+2*Math.PI*(e.length-1)/e.length),a.stroke());var f=e.length;a.font="20px Arial";for(var v=0;v<f;v+=1){var g=l(v/f,d),p=Object(s.a)(g,2),b=p[0],j=p[1];a.beginPath(),a.moveTo(o+b*(c-8),h+j*(c-8)),a.lineTo(o+b*(c+8),h+j*(c+8)),a.stroke();var x=c+20;a.fillText(e[v],o+b*x-7,h+j*x- -7)}var m=a.createLinearGradient(0,0,r,0);m.addColorStop(0,"magenta"),m.addColorStop(.5,"blue"),m.addColorStop(1,"red"),a.strokeStyle=m,a.lineWidth=3;for(var O=0;O<n.length;O+=1){var y=n[O][0]/f,A=n[O][1]/f,B=l(y,d),k=Object(s.a)(B,2),w=k[0],M=k[1],P=l(A,d),N=Object(s.a)(P,2),C=N[0],U=N[1];a.beginPath(),a.moveTo(o+w*c,h+M*c),a.lineTo(o+C*c,h+U*c),a.stroke()}}}(e.current,n,a,e.current.width)}),[]),Object(o.jsx)("canvas",{width:"550",height:"550",ref:e})},d=n(3),f=function(t,e,n){return Math.min(Math.max(t,e),n)};var v,g=function(t){for(var e=t.bases,n=t.pairs,a=e.length,i=[],c=[],s=new Set,l=0;l<n.length;l+=1){var h={source:+n[l][0],target:+n[l][1],value:1,nussinovPair:!0,inBulge:!1,bpLink:!0};h.source<a&&h.target<a&&c.push(h),s.add(h.source),s.add(h.target)}for(l=0;l<a;l+=1)l<a-1&&c.push({source:l,target:l+1,value:1,nussinovPair:!1,inBulge:!s.has(l)||!s.has(l+1),bpLink:!0}),i.push({id:l,bpText:e.charAt(l),isBp:!0,inBulge:s.has(l)});a>0&&(i.push({id:-1,bpText:"start",isBp:!1,inBulge:!1}),i.push({id:a,bpText:"end",isBp:!1,inBulge:!1}),c.push({source:-1,target:0,value:1,nussinovPair:!1,inBulge:!0,bpLink:!1}),c.push({source:a-1,target:a,value:1,nussinovPair:!1,inBulge:!0,bpLink:!1}));var v=function(t){var e=t.nodes,n=t.links,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.width,i=void 0===a?700:a,c=r.height,s=void 0===c?500:c,o=r.windowBuffer,l=void 0===o?10:o,h=r.windowBounds,v=void 0===h?800:h,g=r.ticksPerRender,p=void 0===g?4:g,b=r.linkColor,j=void 0===b?"#555":b,x=r.linkOpacity,m=void 0===x?.7:x,O=r.startStopLinkOpacity,y=void 0===O?.2:O,A=r.nodeRadiusPixels,B=void 0===A?5:A,k=r.startStopRadiusPixels,w=void 0===k?7:k,M=r.nodeColor,P=void 0===M?"#333":M,N=r.nodeFontSizeEm,C=void 0===N?"0.4em":N,U=r.startStopNodeColor,S=void 0===U?"#888":U,G=r.bulgeColor,T=void 0===G?"#252073":G;function L(t){return null!==t&&"object"===typeof t?t.valueOf():t}var I=d.g(e,(function(t){return t.id})).map(L),R=d.g(n,(function(t){return t.source})).map(L),D=d.g(n,(function(t){return t.target})).map(L);e=d.g(e,(function(t,n){return{id:I[n],bpText:e[n].bpText,isBp:e[n].isBp,inBulge:e[n].inBulge}})),n=d.g(n,(function(t,e){return{source:R[e],target:D[e],nussinovPair:n[e].nussinovPair,inBulge:n[e].inBulge,bpLink:n[e].bpLink}}));var F=d.e(),W=d.d(n).id((function(t){var e=t.index;return I[e]}));F.strength(-5),W.strength((function(t){return t.nussinovPair?.5:.8})),W.distance((function(t){return t.nussinovPair?25:t.inBulge?15:8}));var z=d.a("svg").attr("width",i).attr("height",s).attr("viewBox",[-i/2,-s/2,i,s]).attr("style","max-width: 100%; height: auto; height: intrinsic;"),E=!0,J=d.f(e).force("link",W).force("charge",F).force("center",d.c()).on("tick",(function(){if(E)for(var t=u(e.length),n=2*Math.PI,r=e.length,a=0;a<e.length;a+=1)e[a].x=r*Math.cos(t),e[a].y=r*Math.sin(t),t+=n/e.length;E=!1;for(var i=0;i<p;i+=1)J.tick();if(_.attr("x1",(function(t){return t.source.x})).attr("y1",(function(t){return t.source.y})).attr("x2",(function(t){return t.target.x})).attr("y2",(function(t){return t.target.y})),q.attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y})),V.attr("cx",(function(t){return t.x})).attr("cy",(function(t){return t.y})),H.attr("x",(function(t){return t.x})).attr("y",(function(t){return t.y})),e.length>0){for(var c=[e[0].x,e[0].y,e[0].x,e[0].y],s=1;s<e.length;s+=1)c=[Math.min(e[s].x,c[0]),Math.min(e[s].y,c[1]),Math.max(e[s].x,c[2]),Math.max(e[s].y,c[3])];z.attr("viewBox",[f(c[0]-l,-v,v),f(c[1]-l,-v,v),f(c[2]-c[0]+2*l,-v,v),f(c[3]-c[1]+2*l,-v,v)])}})),_=z.append("g").attr("stroke",j).selectAll("line").data(n).join("line").attr("stroke-opacity",(function(t){return t.bpLink?m:y})).attr("stroke-dasharray",(function(t){return t.nussinovPair?"1":""})),q=z.selectAll("circle").attr("stroke",P).data(e).enter().append("g"),V=q.append("circle").attr("r",(function(t){return t.isBp?B:w})).attr("fill",(function(t){return t.isBp?t.inBulge?T:P:S})).call(K(J)),H=q.append("text").style("fill","white").style("font-size",(function(t){return t.isBp?C:"0.3em"})).attr("text-anchor","middle").attr("dy",C).attr("pointer-events","none").text((function(t){return t.bpText}));function K(t){return d.b().on("start",(function(e){e.active||t.alphaTarget(.3).restart(),e.subject.fx=e.subject.x,e.subject.fy=e.subject.y})).on("drag",(function(t){t.subject.fx=t.x,t.subject.fy=t.y})).on("end",(function(e){e.active||t.alphaTarget(0),e.subject.fx=null,e.subject.fy=null}))}return Object.assign(z.node(),{})}({nodes:i,links:c}),g=Object(r.useRef)(null);return Object(r.useEffect)((function(){g.current&&g.current.appendChild(v)}),[]),Object(o.jsx)("svg",{width:"700",height:"500",ref:g})};n(101);function p(t,e,n,r){if(n<r){var a=t[n][r][0];if(a===v.Matched)e.push([n,r]),p(t,e,n+1,r-1);else if(a===v.Left)p(t,e,n,r-1);else if(a===v.Down)p(t,e,n+1,r);else if(a===v.Bifurcate){var i=t[n][r][1];p(t,e,n,i),p(t,e,i+1,r)}else a===v.Unmatched&&p(t,e,n+1,r-1)}}function b(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Set(["AU","UA","GC","CG"]),r=t.length,a=Array.from({length:r},(function(){return Array.from({length:r},(function(){return 0}))})),i=Array.from({length:r},(function(){return Array.from({length:r},(function(){return[v.Unmatched,0]}))})),c=0;c<r;c+=1)for(var s=c-e-1;s>=0;s-=1){var o=a[s+1][c-1],u=[v.Unmatched,0];n.has(t.charAt(s)+t.charAt(c))&&(u=[v.Matched,0],o+=1),a[s+1][c]>o?(u=[v.Down,0],o=a[s+1][c]):a[s][c-1]>o&&(u=[v.Left,0],o=a[s][c-1]);for(var l=s+1;l<c;l+=1)a[s][l]+a[l+1][c]>o&&(u=[v.Bifurcate,l],o=a[s][l]+a[l+1][c]);a[s][c]=o,i[s][c]=u}var h=[];return p(i,h,0,r-1),h}function j(t,e){for(var n=Array(t).fill("."),r=0;r<e.length;r+=1)n[e[r][0]]="(",n[e[r][1]]=")";return n.join("")}!function(t){t[t.Bifurcate=0]="Bifurcate",t[t.Left=1]="Left",t[t.Down=2]="Down",t[t.Matched=3]="Matched",t[t.Unmatched=4]="Unmatched"}(v||(v={}));var x=function(){var t=a.a.useState(""),e=Object(s.a)(t,2),n=e[0],i=e[1],c=a.a.useState([]),u=Object(s.a)(c,2),l=u[0],d=u[1],f=a.a.useState(),v=Object(s.a)(f,2),p=v[0],x=v[1],m=a.a.useState([]),O=Object(s.a)(m,2),y=O[0],A=O[1],B=a.a.useState(!1),k=Object(s.a)(B,2),w=k[0],M=k[1],P=a.a.useState(""),N=Object(s.a)(P,2),C=N[0],U=N[1];function S(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=p;void 0!==e&&(n=e);var r=b(t,n);d(r),U(j(t.length,r))}Object(r.useEffect)((function(){var t="AAAACCAAAGGGGGUUGA";x(2),i(t),S(t)}),[]);var G=y.map((function(t){return Object(o.jsx)("div",{className:"alert alert-info",children:t})})),T=w?Object(o.jsx)("span",{className:"h5 badge bg-primary",style:{transform:"scale(0.7)"},children:"DNA\u279eRNA"}):Object(o.jsx)("span",{});return Object(o.jsxs)("div",{className:"container-md",children:[Object(o.jsx)("h1",{className:"text-center",children:"Nussinov RNA Secondary Structure Visualizer"}),Object(o.jsx)("p",{className:"text-center",children:"by jaa2, Jpn3, and SethWyma"}),Object(o.jsxs)("div",{className:"row g-3",children:[Object(o.jsxs)("div",{className:"col-9",children:[Object(o.jsx)("label",{htmlFor:"bases-input",className:"form-label",children:"Bases of the RNA strand"}),Object(o.jsx)("textarea",{spellCheck:"false",className:"form-control",id:"bases-input",rows:1,placeholder:"AAAACCAAAGGGGGUUGA...",onChange:function(t){!function(t){var e=function(t){var e="";if(">"===t[0]){var n=t.split("\n");n.splice(0,1),e=n.join("")}else e=t;var r=[];(e=e.toUpperCase()).includes("T")&&e.includes("U")&&r.push("Both DNA bases (T) and RNA bases (U) found in input. Mixed input not expected.");var a=(e=(e=e.replace(/\s/g,"")).replace(/T/g,"U")).replaceAll(/[^GACU]/g,"");if(a.length!==e.length){var i="Characters ignored: ".concat(e.replaceAll(/[GACU]/g,""));r.push(i)}return[a,r]}(t),n=Object(s.a)(e,2),r=n[0],a=n[1];a=a.concat(function(t){if(0===t.length)return[];var e=[];if(t.length%3!==0&&e.push("The RNA sequence is not divisible by 3; the string has an ambiguous protein."),t.length>=3){var n="";"UAA"!==(n=n.concat(t[t.length-3].toString(),t[t.length-2].toString(),t[t.length-1].toString()))&&"UAG"!==n&&"UGA"!==n&&e.push("None of the end codons ('UAA,' 'UAG,' or 'UGA') were found at the end of the input.")}return e}(r)),A(a),M(t.toUpperCase().includes("T")),i(r),S(r)}(t.target.value)}})]}),Object(o.jsxs)("div",{className:"col-3",children:[Object(o.jsx)("label",{htmlFor:"bases-input",className:"form-label",children:"Minimum hairpin length"}),Object(o.jsx)("input",{className:"form-control",id:"min-hairpin-input",type:"number",min:"0",value:p,onChange:function(t){!function(t){var e=Math.min(n.length,Math.max(0,t));x(e),S(n,e)}(Number(t.target.value))}})]})]}),Object(o.jsx)("br",{}),Object(o.jsxs)("div",{className:"d-flex flex-row flex-wrap graphs-box mb-4",children:[Object(o.jsxs)("div",{children:[Object(o.jsxs)("h3",{className:"text-center",children:["Nussinov Plot",T]}),Object(o.jsx)("div",{style:{width:"550px",height:"550px"},children:Object(o.jsx)(h,{bases:n,pairs:l},"C".concat(n,"_").concat(p))})]}),Object(o.jsxs)("div",{children:[Object(o.jsx)("h3",{className:"text-center",children:"Force-Directed Graph"}),Object(o.jsx)("div",{style:{width:"700px",height:"500px"},children:Object(o.jsx)(g,{bases:n,pairs:l},"F".concat(n,"_").concat(p))})]})]}),Object(o.jsx)("br",{}),Object(o.jsx)("h3",{children:"Dot-Parentheses Format"}),Object(o.jsx)("div",{className:"px-2",style:{backgroundColor:"#868e96",color:"#dee2e6",fontFamily:"monospace",borderRadius:"10px",overflowWrap:"anywhere"},children:C}),Object(o.jsx)("br",{}),G]})};c.a.render(Object(o.jsx)(a.a.StrictMode,{children:Object(o.jsx)(x,{})}),document.getElementById("root"))}},[[102,1,2]]]);
//# sourceMappingURL=main.bb2492df.chunk.js.map